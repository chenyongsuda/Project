1.检查语法
ansible-playbook web.yml --syntax-check  #检查语法


2.自动权限升级
# https://docs.ansible.com/ansible/become.html#becoming-an-unprivileged-user
# If 'true' unparsed inventory sources become fatal errors, they are warnings otherwise.
become=True
#become_method=sudo
#become_user=root
#become_ask_pass=False

如果配置了秘钥的话只需要打开become

3.添加证书key模块
authorized_key 模块

4.添加sudoer用户
- name: update sudoers file
      lineinfile:
        dest: /etc/sudoers
        insertafter: '^tidb'
        line: '{{ username }} ALL=(ALL) NOPASSWD: ALL'
        regexp: '^tidb'
        state: present


