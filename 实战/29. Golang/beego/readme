beegoè·¯ç”±è®¾ç½®
beegoå­˜åœ¨ä¸‰ç§æ–¹å¼çš„è·¯ç”±ï¼šå›ºå®šè·¯ç”±ã€æ­£åˆ™è·¯ç”±ã€è‡ªåŠ¨è·¯ç”±ã€‚ä¸‹é¢å°±è¯¦ç»†è¯´ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨è¿™ä¸‰ç§è·¯ç”±ã€‚

==============================
åŸºç¡€è·¯ç”±
ä» beego 1.2 ç‰ˆæœ¬å¼€å§‹æ”¯æŒäº†åŸºæœ¬çš„ RESTful å‡½æ•°å¼è·¯ç”±,åº”ç”¨ä¸­çš„å¤§å¤šæ•°è·¯ç”±éƒ½ä¼šå®šä¹‰åœ¨ routers/router.go æ–‡ä»¶ä¸­ã€‚æœ€ç®€å•çš„ beego è·¯ç”±ç”± URI å’Œé—­åŒ…å‡½æ•°ç»„æˆã€‚

åŸºæœ¬GETè·¯ç”±
beego.Get("/",func(ctx *context.Context){
     ctx.Output.Body([]byte("hello world"))
})
åŸºæœ¬POSTè·¯ç”±
beego.Post("/alice",func(ctx *context.Context){
     ctx.Output.Body([]byte("bob"))
})
å¯ä»¥å“åº”ä»»ä½•HTTPè¯·æ±‚çš„è·¯ç”±
beego.Any("/foo",func(ctx *context.Context){
     ctx.Output.Body([]byte("bar"))
})
æ‰€æœ‰çš„æ”¯æŒçš„åŸºç¡€å‡½æ•°ï¼š
beego.Get(router, beego.FilterFunc)
beego.Post(router, beego.FilterFunc)
beego.Put(router, beego.FilterFunc)
beego.Patch(router, beego.FilterFunc)
beego.Head(router, beego.FilterFunc)
beego.Options(router, beego.FilterFunc)
beego.Delete(router, beego.FilterFunc)
beego.Any(router, beego.FilterFunc)


============================================
å›ºå®šè·¯ç”±
å›ºå®šè·¯ç”±ä¹Ÿå°±æ˜¯å…¨åŒ¹é…çš„è·¯ç”±ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

beego.Router("/", &controllers.MainController{})
beego.Router("/admin", &admin.UserController{})
beego.Router("/admin/index", &admin.ArticleController{})
beego.Router("/admin/addpkg", &admin.AddController{})
å¦‚ä¸Šæ‰€ç¤ºçš„è·¯ç”±å°±æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„è·¯ç”±æ–¹å¼ï¼Œä¸€ä¸ªå›ºå®šçš„è·¯ç”±ï¼Œä¸€ä¸ªæ§åˆ¶å™¨ï¼Œç„¶åæ ¹æ®ç”¨æˆ·è¯·æ±‚æ–¹æ³•ä¸åŒè¯·æ±‚æ§åˆ¶å™¨ä¸­å¯¹åº”çš„æ–¹æ³•ï¼Œå…¸å‹çš„ RESTful æ–¹å¼ã€‚

RESTful æ˜¯ä¸€ç§ç›®å‰ API å¼€å‘ä¸­å¹¿æ³›é‡‡ç”¨çš„å½¢å¼ï¼Œbeego é»˜è®¤å°±æ˜¯æ”¯æŒè¿™æ ·çš„è¯·æ±‚æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ· Get è¯·æ±‚å°±æ‰§è¡Œ Get æ–¹æ³•ï¼ŒPost è¯·æ±‚å°±æ‰§è¡Œ Post æ–¹æ³•ã€‚å› æ­¤é»˜è®¤çš„è·¯ç”±æ˜¯è¿™æ · RESTful çš„è¯·æ±‚æ–¹å¼ã€‚



=================================================
æ­£åˆ™è·¯ç”±
ä¸ºäº†ç”¨æˆ·æ›´åŠ æ–¹ä¾¿çš„è·¯ç”±è®¾ç½®ï¼Œbeego å‚è€ƒäº† sinatra çš„è·¯ç”±å®ç°ï¼Œæ”¯æŒå¤šç§æ–¹å¼çš„è·¯ç”±ï¼š

beego.Router("/api/?:id", &controllers.RController{})
é»˜è®¤åŒ¹é… //ä¾‹å¦‚å¯¹äºURL"/api/123"å¯ä»¥åŒ¹é…æˆåŠŸï¼Œæ­¤æ—¶å˜é‡":id"å€¼ä¸º"123"

beego.Router("/api/:id", &controllers.RController{})
é»˜è®¤åŒ¹é… //ä¾‹å¦‚å¯¹äºURL"/api/123"å¯ä»¥åŒ¹é…æˆåŠŸï¼Œæ­¤æ—¶å˜é‡":id"å€¼ä¸º"123"ï¼Œä½†URL"/api/"åŒ¹é…å¤±è´¥

beego.Router("/api/:id([0-9]+)", &controllers.RController{})
è‡ªå®šä¹‰æ­£åˆ™åŒ¹é… //ä¾‹å¦‚å¯¹äºURL"/api/123"å¯ä»¥åŒ¹é…æˆåŠŸï¼Œæ­¤æ—¶å˜é‡":id"å€¼ä¸º"123"

beego.Router("/user/:username([\\w]+)", &controllers.RController{})
æ­£åˆ™å­—ç¬¦ä¸²åŒ¹é… //ä¾‹å¦‚å¯¹äºURL"/user/astaxie"å¯ä»¥åŒ¹é…æˆåŠŸï¼Œæ­¤æ—¶å˜é‡":username"å€¼ä¸º"astaxie"

beego.Router("/download/*.*", &controllers.RController{})
*åŒ¹é…æ–¹å¼ //ä¾‹å¦‚å¯¹äºURL"/download/file/api.xml"å¯ä»¥åŒ¹é…æˆåŠŸï¼Œæ­¤æ—¶å˜é‡":path"å€¼ä¸º"file/api"ï¼Œ ":ext"å€¼ä¸º"xml"

beego.Router("/download/ceshi/*", &controllers.RController{})
*å…¨åŒ¹é…æ–¹å¼ //ä¾‹å¦‚å¯¹äºURL"/download/ceshi/file/api.json"å¯ä»¥åŒ¹é…æˆåŠŸï¼Œæ­¤æ—¶å˜é‡":splat"å€¼ä¸º"file/api.json"

beego.Router("/ğŸ†”int", &controllers.RController{})
int ç±»å‹è®¾ç½®æ–¹å¼ï¼ŒåŒ¹é… :idä¸ºint ç±»å‹ï¼Œæ¡†æ¶å¸®ä½ å®ç°äº†æ­£åˆ™ ([0-9]+)

beego.Router("/:hi:string", &controllers.RController{})
string ç±»å‹è®¾ç½®æ–¹å¼ï¼ŒåŒ¹é… :hi ä¸º string ç±»å‹ã€‚æ¡†æ¶å¸®ä½ å®ç°äº†æ­£åˆ™ ([\w]+)

beego.Router("/cms_:id([0-9]+).html", &controllers.CmsController{})
å¸¦æœ‰å‰ç¼€çš„è‡ªå®šä¹‰æ­£åˆ™ //åŒ¹é… :id ä¸ºæ­£åˆ™ç±»å‹ã€‚åŒ¹é… cms_123.html è¿™æ ·çš„ url :id = 123

å¯ä»¥åœ¨ Controller ä¸­é€šè¿‡å¦‚ä¸‹æ–¹å¼è·å–ä¸Šé¢çš„å˜é‡ï¼š

this.Ctx.Input.Param(":id")
this.Ctx.Input.Param(":username")
this.Ctx.Input.Param(":splat")
this.Ctx.Input.Param(":path")
this.Ctx.Input.Param(":ext")
è‡ªå®šä¹‰æ–¹æ³•åŠ RESTful è§„åˆ™
ä¸Šé¢åˆ—ä¸¾çš„æ˜¯é»˜è®¤çš„è¯·æ±‚æ–¹æ³•åï¼ˆè¯·æ±‚çš„ method å’Œå‡½æ•°åä¸€è‡´ï¼Œä¾‹å¦‚ GET è¯·æ±‚æ‰§è¡Œ Get å‡½æ•°ï¼ŒPOST è¯·æ±‚æ‰§è¡Œ Post å‡½æ•°ï¼‰ï¼Œå¦‚æœç”¨æˆ·æœŸæœ›è‡ªå®šä¹‰å‡½æ•°åï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ï¼š

beego.Router("/",&IndexController{},"*:Index")
ä½¿ç”¨ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å°±æ˜¯ç”¨æ¥è®¾ç½®å¯¹åº” method åˆ°å‡½æ•°åï¼Œå®šä¹‰å¦‚ä¸‹

*è¡¨ç¤ºä»»æ„çš„ method éƒ½æ‰§è¡Œè¯¥å‡½æ•°
ä½¿ç”¨ httpmethod:funcname æ ¼å¼æ¥å±•ç¤º
å¤šä¸ªä¸åŒçš„æ ¼å¼ä½¿ç”¨ ; åˆ†å‰²
å¤šä¸ª method å¯¹åº”åŒä¸€ä¸ª funcnameï¼Œmethod ä¹‹é—´é€šè¿‡ , æ¥åˆ†å‰²
ä»¥ä¸‹æ˜¯ä¸€ä¸ª RESTful çš„è®¾è®¡ç¤ºä¾‹ï¼š

beego.Router("/api/list",&RestController{},"*:ListFood")
beego.Router("/api/create",&RestController{},"post:CreateFood")
beego.Router("/api/update",&RestController{},"put:UpdateFood")
beego.Router("/api/delete",&RestController{},"delete:DeleteFood")
ä»¥ä¸‹æ˜¯å¤šä¸ª HTTP Method æŒ‡å‘åŒä¸€ä¸ªå‡½æ•°çš„ç¤ºä¾‹ï¼š

beego.Router("/api",&RestController{},"get,post:ApiFunc")
ä»¥ä¸‹æ˜¯ä¸åŒçš„ method å¯¹åº”ä¸åŒçš„å‡½æ•°ï¼Œé€šè¿‡ ; è¿›è¡Œåˆ†å‰²çš„ç¤ºä¾‹ï¼š

beego.Router("/simple",&SimpleController{},"get:GetFunc;post:PostFunc")
å¯ç”¨çš„ HTTP Methodï¼š
*: åŒ…å«ä»¥ä¸‹æ‰€æœ‰çš„å‡½æ•°

get: GET è¯·æ±‚
post: POST è¯·æ±‚
put: PUT è¯·æ±‚
delete: DELETE è¯·æ±‚
patch: PATCH è¯·æ±‚
options: OPTIONS è¯·æ±‚
head: HEAD è¯·æ±‚
å¦‚æœåŒæ—¶å­˜åœ¨ * å’Œå¯¹åº”çš„ HTTP Methodï¼Œé‚£ä¹ˆä¼˜å…ˆæ‰§è¡Œ HTTP Method çš„æ–¹æ³•ï¼Œä¾‹å¦‚åŒæ—¶æ³¨å†Œäº†å¦‚ä¸‹æ‰€ç¤ºçš„è·¯ç”±ï¼š
beego.Router("/simple",&SimpleController{},"*:AllFunc;post:PostFunc")
é‚£ä¹ˆæ‰§è¡Œ POST è¯·æ±‚çš„æ—¶å€™ï¼Œæ‰§è¡Œ PostFunc è€Œä¸æ‰§è¡Œ AllFuncã€‚

è‡ªå®šä¹‰å‡½æ•°çš„è·¯ç”±é»˜è®¤ä¸æ”¯æŒ RESTful çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯å¦‚æœä½ è®¾ç½®äº† beego.Router("/api",&RestController{},"post:ApiFunc") è¿™æ ·çš„è·¯ç”±ï¼Œå¦‚æœè¯·æ±‚çš„æ–¹æ³•æ˜¯ POSTï¼Œé‚£ä¹ˆä¸ä¼šé»˜è®¤å»æ‰§è¡Œ Post å‡½æ•°ã€‚


==================================
è‡ªåŠ¨è·¯ç”±
ç”¨æˆ·é¦–å…ˆéœ€è¦æŠŠéœ€è¦è·¯ç”±çš„æ§åˆ¶å™¨æ³¨å†Œåˆ°è‡ªåŠ¨è·¯ç”±ä¸­ï¼š
beego.AutoRouter(&controllers.ObjectController{})
é‚£ä¹ˆ beego å°±ä¼šé€šè¿‡åå°„è·å–è¯¥ç»“æ„ä½“ä¸­æ‰€æœ‰çš„å®ç°æ–¹æ³•ï¼Œä½ å°±å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹å¼è®¿é—®åˆ°å¯¹åº”çš„æ–¹æ³•ä¸­ï¼š

/object/login è°ƒç”¨ ObjectController ä¸­çš„ Login æ–¹æ³•
/object/logout è°ƒç”¨ ObjectController ä¸­çš„ Logout æ–¹æ³•

é™¤äº†å‰ç¼€ä¸¤ä¸ª /:controller/:method çš„åŒ¹é…ä¹‹å¤–ï¼Œå‰©ä¸‹çš„ url beego ä¼šå¸®ä½ è‡ªåŠ¨åŒ–è§£æä¸ºå‚æ•°ï¼Œä¿å­˜åœ¨ this.Ctx.Input.Params å½“ä¸­ï¼š

/object/blog/2013/09/12 è°ƒç”¨ ObjectController ä¸­çš„ Blog æ–¹æ³•ï¼Œå‚æ•°å¦‚ä¸‹ï¼š

æ–¹æ³•ååœ¨å†…éƒ¨æ˜¯ä¿å­˜äº†ç”¨æˆ·è®¾ç½®çš„ï¼Œä¾‹å¦‚ Loginï¼Œurl åŒ¹é…çš„æ—¶å€™éƒ½ä¼šè½¬åŒ–ä¸ºå°å†™ï¼Œæ‰€ä»¥ï¼Œ/object/LOGIN è¿™æ ·çš„ url ä¹Ÿä¸€æ ·å¯ä»¥è·¯ç”±åˆ°ç”¨æˆ·å®šä¹‰çš„ Login æ–¹æ³•ä¸­ã€‚
ç°åœ¨å·²ç»å¯ä»¥é€šè¿‡è‡ªåŠ¨è¯†åˆ«å‡ºæ¥ä¸‹é¢ç±»ä¼¼çš„æ‰€æœ‰ urlï¼Œéƒ½ä¼šæŠŠè¯·æ±‚åˆ†å‘åˆ° controller çš„ simple æ–¹æ³•ï¼š
/controller/simple
/controller/simple.html
/controller/simple.json
/controller/simple.xml
å¯ä»¥é€šè¿‡ this.Ctx.Input.Param(":ext") è·å–åç¼€åã€‚
